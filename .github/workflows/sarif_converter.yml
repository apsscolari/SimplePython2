name: convert-to-sarif

on: workflow_dispatch

jobs:
  upload-sarif:
    runs-on: ubuntu-24.04
    permissions:
      security-events: write
      actions: read
      contents: read

    steps:
      - name: "check out repo files"
      - uses: actions/checkout@v4

      - name: "run the converter"
      - uses: airtower-luna/convert-to-sarif@main
        with:
          tool: 'Sonarqube'
          input_file: 'report.xml'
          sarif_file: 'report.sarif'
      
      - name: "upload the converted file"
      - uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: report.sarif
          category: cppcheck
